#ifndef __COSMOLIKE_HALO_H
#define __COSMOLIKE_HALO_H
#ifdef __cplusplus
extern "C" {
#endif

// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// halo model routines to convert scales/radii to halo masses, and vice versa
// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------

double delta_c(double a);

double m_Delta(const double r, const double a);

double r_Delta(const double m, const double a);

double bias_norm(const double a);

double massfunc(const double m, const double a); 

double bias_norm(const double a);

double mass_norm(const double a);

double B1_nu(const double n, const double a);

double B1(const double m, const double a);

double radius(const double m) ;

// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// Variance of the density field
// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------

double sigma2(const double M);

// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// \nu
// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------

double nu(const double M, const double a);

double nuv2(const double M, const double a, const double growfac);

double dlognudlogm(const double M);

// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// halo density profiles
// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------

double conc(const double m, const double a); // mass-concentration relation

// Analytic expression for FT of NFW density profile
double u_nfw_c(const double c, const double k, const double m,const double a);

// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// matter power spectrum
// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------

double p_mm_halomodel_noiterp(const double k, const double a, const int init_static_vars_only);

double p_mm_halomodel(const double k, const double a);

// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// Simplistic abundance matching to get approximate b(z) of source galaxies
// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------

// comoving source galaxy density based on n_gal +n(z)
double n_s_cmv(double a);

// simple abundance matching routine to get bias for
// source galaxies from redshift distribution
double b_ngmatched(double a, double n_cmv);

double b_source(double a); // lookup table for b1 of source galaxies

// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// functions important for y correlation functions
// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------

double p_yy_noiterp(const double k, const double a, const int use_2h_only, 
const int init_static_vars_only);

double p_yy(const double k, const double a, const int use_2h_only);

double p_my_noiterp(const double k, const double a, const int use_2h_only,
const int init_static_vars_only);

double p_my(const double k, const double a, const int use_2h_only);


// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// HOD
// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------

double p_gg_nointerp(const double k, const double a, const int ni, const int use_2h_and_linear_only,
const int init_static_vars_only);

double p_gg(const double k, const double a, const int ni, const const int use_2h_and_linear_only);

double p_gm_nointerp(const double k, const double a, const int ni, const int use_2h_and_linear_only, 
const int init_static_vars_only);

double p_gm (const double k, const double a, const int ni, const int use_2h_and_linear_only);

#ifdef __cplusplus
}
#endif
#endif // HEADER GUARD